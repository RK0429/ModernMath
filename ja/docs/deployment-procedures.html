<!DOCTYPE html>

<html lang="ja" xml:lang="ja" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta charset="utf-8"/>
<meta content="quarto-1.7.32" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<meta content="Step-by-step guide for deploying the ModernMath Knowledge Graph system" name="description"/>
<title>Deployment Procedures ‚Äì Êï∞Â≠¶„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„Éï</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>
<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta content="../" name="quarto:offset"/>
<link href="../favicon.ico" rel="icon"/>
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" id="quarto-text-highlighting-styles" rel="stylesheet"/>
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"/>
<link append-hash="true" data-mode="light" href="../site_libs/bootstrap/bootstrap-316cf67538289ea5aad5d61736e73c8a.min.css" id="quarto-bootstrap" rel="stylesheet"/>
<link href="../site_libs/quarto-contrib/math-environments-1.0.0/math-environments.css" rel="stylesheet"/>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "‰∏ÄËá¥„Å™„Åó",
    "search-matching-documents-text": "‰∏ÄËá¥„Åó„ÅüÊñáÊõ∏",
    "search-copy-link-title": "Ê§úÁ¥¢„Å∏„ÅÆ„É™„É≥„ÇØ„Çí„Ç≥„Éî„Éº",
    "search-hide-matches-text": "ËøΩÂä†„ÅÆÊ§úÁ¥¢ÁµêÊûú„ÇíÈùûË°®Á§∫",
    "search-more-match-text": "ËøΩÂä†„ÅÆÊ§úÁ¥¢ÁµêÊûú",
    "search-more-matches-text": "ËøΩÂä†„ÅÆÊ§úÁ¥¢ÁµêÊûú",
    "search-clear-button-title": "Ê∂àÂéª",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "ÂèñÊ∂à",
    "search-submit-button-title": "Ê§úÁ¥¢",
    "search-label": "„Çµ„Éº„ÉÅ"
  }
}</script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet"/>
<script>
  window.siteLanguage = 'ja';
  window.alternateLanguage = 'en';
  window.alternateLanguageUrl = '../en/';
  // Calculate the correct path to js directory based on current location
  (function() {
    var path = window.location.pathname;

    // Find the base path for the Japanese site
    // Look for where '/ja/' appears in the path
    var jaIndex = path.indexOf('/ja/');
    var basePath = '';

    if (jaIndex !== -1) {
      // Extract everything up to and including '/ja/'
      var siteRoot = path.substring(0, jaIndex + 4); // +4 to include '/ja/'
      basePath = siteRoot;
    } else {
      // Fallback: calculate relative path
      var pathParts = path.split('/').filter(function(part) {
        return part && !part.endsWith('.html');
      });

      // Count depth and build relative path
      var depth = pathParts.length;
      for (var i = 0; i < depth; i++) {
        basePath += '../';
      }
    }

    // Ensure basePath ends with /
    if (basePath && !basePath.endsWith('/')) {
      basePath += '/';
    }

    // Load language switcher
    var script = document.createElement('script');
    script.src = basePath + 'js/language-switcher.js';
    script.defer = true;
    document.head.appendChild(script);

    // Load issue button
    var issueScript = document.createElement('script');
    issueScript.src = basePath + 'js/issue-button.js';
    issueScript.defer = true;
    document.head.appendChild(issueScript);
  })();
</script>
<link href="../styles.css" rel="stylesheet"/>
<link href="../styles-multilingual.css" rel="stylesheet"/>
<style>
        .bmc-custom-button {
            position: fixed;
            bottom: 70px; /* Positioned above Report Issue button */
            right: 20px;
            background-color: #FFDD00;
            color: #000000;
            padding: 10px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
            z-index: 999; /* Slightly below Report Issue button */
        }

        .bmc-custom-button:hover {
            background-color: #FFD814;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            text-decoration: none;
        }

        .bmc-custom-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .bmc-custom-button img {
            height: 16px !important;
            width: auto !important;
            margin: 0;
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .bmc-custom-button {
                bottom: 60px;
                right: 10px;
                padding: 8px 12px;
                font-size: 13px;
            }
        }

        /* Hide on print */
        @media print {
            .bmc-custom-button {
                display: none;
            }
        }
        </style></head>
<body class="nav-fixed quarto-light">
<div id="quarto-search-results"></div>
<header class="headroom fixed-top" id="quarto-header">
<nav class="navbar navbar-expand-lg" data-bs-theme="dark">
<div class="navbar-container container-fluid">
<div class="navbar-brand-container mx-auto">
<a class="navbar-brand" href="../index.html">
<span class="navbar-title">Êï∞Â≠¶„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„Éï</span>
</a>
</div>
<div class="" id="quarto-search" title="„Çµ„Éº„ÉÅ"></div>
<button aria-controls="navbarCollapse" aria-expanded="false" aria-label="„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„ÇíÂàá„ÇäÊõø„Åà„Çã" class="navbar-toggler" data-bs-target="#navbarCollapse" data-bs-toggle="collapse" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }" role="menu" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarCollapse">
<ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
<a class="nav-link" href="../index-ja.html">
<span class="menu-text">„Éõ„Éº„É†</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/algebra/index.html">
<span class="menu-text">‰ª£Êï∞Â≠¶</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/analysis/index.html">
<span class="menu-text">Ëß£ÊûêÂ≠¶</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/topology/index.html">
<span class="menu-text">‰ΩçÁõ∏Á©∫ÈñìË´ñ</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/geometry/index.html">
<span class="menu-text">Âπæ‰ΩïÂ≠¶</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/category-theory/index.html">
<span class="menu-text">ÂúèË´ñ</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/combinatorics/index.html">
<span class="menu-text">ÁµÑÂêà„ÅõË´ñ</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/logic-set-theory/index.html">
<span class="menu-text">Ë´ñÁêÜÂ≠¶„ÉªÈõÜÂêàË´ñ</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/number-theory/index.html">
<span class="menu-text">Êï∞Ë´ñ</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../content/ja/probability-statistics/index.html">
<span class="menu-text">Á¢∫ÁéáÁµ±Ë®à</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../nav/ja/about.html">
<span class="menu-text">Ê¶ÇË¶Å</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../nav/ja/contributing.html">
<span class="menu-text">Ë≤¢ÁåÆ</span></a>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
<a class="nav-link" href="https://github.com/RK0429/ModernMath"> <i aria-label="github" class="bi bi-github" role="img">
</i>
<span class="menu-text"></span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="../../en/index.html">
<span class="menu-text">üåê English</span></a>
</li>
</ul>
</div> <!-- /navcollapse -->
<div class="quarto-navbar-tools">
</div>
</div> <!-- /container-fluid -->
</nav>
</header>
<!-- content -->
<div class="quarto-container page-columns page-rows-contents page-layout-article page-navbar" id="quarto-content">
<!-- sidebar -->
<!-- margin-sidebar -->
<div class="sidebar margin-sidebar" id="quarto-margin-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc">
<h2 id="toc-title">ÁõÆÊ¨°</h2>
<ul>
<li><a class="nav-link active" data-scroll-target="#overview" href="#overview" id="toc-overview"><span class="header-section-number">1</span> Overview</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#deployment-components" href="#deployment-components" id="toc-deployment-components"><span class="header-section-number">1.1</span> Deployment Components</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#prerequisites" href="#prerequisites" id="toc-prerequisites"><span class="header-section-number">2</span> Prerequisites</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#system-requirements" href="#system-requirements" id="toc-system-requirements"><span class="header-section-number">2.1</span> System Requirements</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#development-environment" href="#development-environment" id="toc-development-environment"><span class="header-section-number">2.1.1</span> Development Environment</a></li>
<li><a class="nav-link" data-scroll-target="#production-environment" href="#production-environment" id="toc-production-environment"><span class="header-section-number">2.1.2</span> Production Environment</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#required-accounts" href="#required-accounts" id="toc-required-accounts"><span class="header-section-number">2.2</span> Required Accounts</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#local-development-deployment" href="#local-development-deployment" id="toc-local-development-deployment"><span class="header-section-number">3</span> Local Development Deployment</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#step-1-clone-and-setup-repository" href="#step-1-clone-and-setup-repository" id="toc-step-1-clone-and-setup-repository"><span class="header-section-number">3.1</span> Step 1: Clone and Setup Repository</a></li>
<li><a class="nav-link" data-scroll-target="#step-2-build-the-knowledge-graph" href="#step-2-build-the-knowledge-graph" id="toc-step-2-build-the-knowledge-graph"><span class="header-section-number">3.2</span> Step 2: Build the Knowledge Graph</a></li>
<li><a class="nav-link" data-scroll-target="#step-3-start-backend-services" href="#step-3-start-backend-services" id="toc-step-3-start-backend-services"><span class="header-section-number">3.3</span> Step 3: Start Backend Services</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#start-fuseki-sparql-endpoint" href="#start-fuseki-sparql-endpoint" id="toc-start-fuseki-sparql-endpoint"><span class="header-section-number">3.3.1</span> Start Fuseki SPARQL Endpoint</a></li>
<li><a class="nav-link" data-scroll-target="#load-data-into-fuseki" href="#load-data-into-fuseki" id="toc-load-data-into-fuseki"><span class="header-section-number">3.3.2</span> Load Data into Fuseki</a></li>
<li><a class="nav-link" data-scroll-target="#start-flask-api" href="#start-flask-api" id="toc-start-flask-api"><span class="header-section-number">3.3.3</span> Start Flask API</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#step-4-build-and-preview-website" href="#step-4-build-and-preview-website" id="toc-step-4-build-and-preview-website"><span class="header-section-number">3.4</span> Step 4: Build and Preview Website</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#github-pages-deployment" href="#github-pages-deployment" id="toc-github-pages-deployment"><span class="header-section-number">4</span> GitHub Pages Deployment</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#step-1-configure-repository" href="#step-1-configure-repository" id="toc-step-1-configure-repository"><span class="header-section-number">4.1</span> Step 1: Configure Repository</a></li>
<li><a class="nav-link" data-scroll-target="#step-2-setup-github-actions" href="#step-2-setup-github-actions" id="toc-step-2-setup-github-actions"><span class="header-section-number">4.2</span> Step 2: Setup GitHub Actions</a></li>
<li><a class="nav-link" data-scroll-target="#step-3-trigger-deployment" href="#step-3-trigger-deployment" id="toc-step-3-trigger-deployment"><span class="header-section-number">4.3</span> Step 3: Trigger Deployment</a></li>
<li><a class="nav-link" data-scroll-target="#step-4-verify-deployment" href="#step-4-verify-deployment" id="toc-step-4-verify-deployment"><span class="header-section-number">4.4</span> Step 4: Verify Deployment</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#production-server-deployment" href="#production-server-deployment" id="toc-production-server-deployment"><span class="header-section-number">5</span> Production Server Deployment</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#step-1-server-preparation" href="#step-1-server-preparation" id="toc-step-1-server-preparation"><span class="header-section-number">5.1</span> Step 1: Server Preparation</a></li>
<li><a class="nav-link" data-scroll-target="#step-2-clone-and-setup-application" href="#step-2-clone-and-setup-application" id="toc-step-2-clone-and-setup-application"><span class="header-section-number">5.2</span> Step 2: Clone and Setup Application</a></li>
<li><a class="nav-link" data-scroll-target="#step-3-configure-fuseki-service" href="#step-3-configure-fuseki-service" id="toc-step-3-configure-fuseki-service"><span class="header-section-number">5.3</span> Step 3: Configure Fuseki Service</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#create-systemd-service" href="#create-systemd-service" id="toc-create-systemd-service"><span class="header-section-number">5.3.1</span> Create Systemd Service</a></li>
<li><a class="nav-link" data-scroll-target="#start-fuseki" href="#start-fuseki" id="toc-start-fuseki"><span class="header-section-number">5.3.2</span> Start Fuseki</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#step-4-configure-flask-api-service" href="#step-4-configure-flask-api-service" id="toc-step-4-configure-flask-api-service"><span class="header-section-number">5.4</span> Step 4: Configure Flask API Service</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#create-systemd-service-1" href="#create-systemd-service-1" id="toc-create-systemd-service-1"><span class="header-section-number">5.4.1</span> Create Systemd Service</a></li>
<li><a class="nav-link" data-scroll-target="#start-api-service" href="#start-api-service" id="toc-start-api-service"><span class="header-section-number">5.4.2</span> Start API Service</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#step-5-configure-nginx" href="#step-5-configure-nginx" id="toc-step-5-configure-nginx"><span class="header-section-number">5.5</span> Step 5: Configure Nginx</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#create-nginx-configuration" href="#create-nginx-configuration" id="toc-create-nginx-configuration"><span class="header-section-number">5.5.1</span> Create Nginx Configuration</a></li>
<li><a class="nav-link" data-scroll-target="#enable-site" href="#enable-site" id="toc-enable-site"><span class="header-section-number">5.5.2</span> Enable Site</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#step-6-setup-ssl-with-lets-encrypt" href="#step-6-setup-ssl-with-lets-encrypt" id="toc-step-6-setup-ssl-with-lets-encrypt"><span class="header-section-number">5.6</span> Step 6: Setup SSL with Let‚Äôs Encrypt</a></li>
<li><a class="nav-link" data-scroll-target="#step-7-deploy-website-content" href="#step-7-deploy-website-content" id="toc-step-7-deploy-website-content"><span class="header-section-number">5.7</span> Step 7: Deploy Website Content</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#continuous-deployment-setup" href="#continuous-deployment-setup" id="toc-continuous-deployment-setup"><span class="header-section-number">6</span> Continuous Deployment Setup</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#github-actions-for-auto-deploy" href="#github-actions-for-auto-deploy" id="toc-github-actions-for-auto-deploy"><span class="header-section-number">6.1</span> GitHub Actions for Auto-Deploy</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#create-deploy-script" href="#create-deploy-script" id="toc-create-deploy-script"><span class="header-section-number">6.1.1</span> Create Deploy Script</a></li>
<li><a class="nav-link" data-scroll-target="#setup-webhook" href="#setup-webhook" id="toc-setup-webhook"><span class="header-section-number">6.1.2</span> Setup Webhook</a></li>
</ul></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#monitoring-and-maintenance" href="#monitoring-and-maintenance" id="toc-monitoring-and-maintenance"><span class="header-section-number">7</span> Monitoring and Maintenance</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#health-checks" href="#health-checks" id="toc-health-checks"><span class="header-section-number">7.1</span> Health Checks</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#create-monitoring-script" href="#create-monitoring-script" id="toc-create-monitoring-script"><span class="header-section-number">7.1.1</span> Create Monitoring Script</a></li>
<li><a class="nav-link" data-scroll-target="#setup-cron-job" href="#setup-cron-job" id="toc-setup-cron-job"><span class="header-section-number">7.1.2</span> Setup Cron Job</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#backup-procedures" href="#backup-procedures" id="toc-backup-procedures"><span class="header-section-number">7.2</span> Backup Procedures</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#daily-backup-script" href="#daily-backup-script" id="toc-daily-backup-script"><span class="header-section-number">7.2.1</span> Daily Backup Script</a></li>
<li><a class="nav-link" data-scroll-target="#schedule-backup" href="#schedule-backup" id="toc-schedule-backup"><span class="header-section-number">7.2.2</span> Schedule Backup</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#log-management" href="#log-management" id="toc-log-management"><span class="header-section-number">7.3</span> Log Management</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#configure-log-rotation" href="#configure-log-rotation" id="toc-configure-log-rotation"><span class="header-section-number">7.3.1</span> Configure Log Rotation</a></li>
</ul></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#rollback-procedures" href="#rollback-procedures" id="toc-rollback-procedures"><span class="header-section-number">8</span> Rollback Procedures</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#quick-rollback" href="#quick-rollback" id="toc-quick-rollback"><span class="header-section-number">8.1</span> Quick Rollback</a></li>
<li><a class="nav-link" data-scroll-target="#database-rollback" href="#database-rollback" id="toc-database-rollback"><span class="header-section-number">8.2</span> Database Rollback</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#performance-optimization" href="#performance-optimization" id="toc-performance-optimization"><span class="header-section-number">9</span> Performance Optimization</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#enable-caching" href="#enable-caching" id="toc-enable-caching"><span class="header-section-number">9.1</span> Enable Caching</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#nginx-caching" href="#nginx-caching" id="toc-nginx-caching"><span class="header-section-number">9.1.1</span> Nginx Caching</a></li>
<li><a class="nav-link" data-scroll-target="#api-response-caching" href="#api-response-caching" id="toc-api-response-caching"><span class="header-section-number">9.1.2</span> API Response Caching</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#cdn-setup-optional" href="#cdn-setup-optional" id="toc-cdn-setup-optional"><span class="header-section-number">9.2</span> CDN Setup (Optional)</a></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#troubleshooting-deployment" href="#troubleshooting-deployment" id="toc-troubleshooting-deployment"><span class="header-section-number">10</span> Troubleshooting Deployment</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#common-issues" href="#common-issues" id="toc-common-issues"><span class="header-section-number">10.1</span> Common Issues</a>
<ul class="collapse">
<li><a class="nav-link" data-scroll-target="#port-already-in-use" href="#port-already-in-use" id="toc-port-already-in-use"><span class="header-section-number">10.1.1</span> Port Already in Use</a></li>
<li><a class="nav-link" data-scroll-target="#permission-errors" href="#permission-errors" id="toc-permission-errors"><span class="header-section-number">10.1.2</span> Permission Errors</a></li>
<li><a class="nav-link" data-scroll-target="#service-wont-start" href="#service-wont-start" id="toc-service-wont-start"><span class="header-section-number">10.1.3</span> Service Won‚Äôt Start</a></li>
</ul></li>
</ul></li>
<li><a class="nav-link" data-scroll-target="#security-checklist" href="#security-checklist" id="toc-security-checklist"><span class="header-section-number">11</span> Security Checklist</a></li>
<li><a class="nav-link" data-scroll-target="#post-deployment-verification" href="#post-deployment-verification" id="toc-post-deployment-verification"><span class="header-section-number">12</span> Post-Deployment Verification</a></li>
</ul>
</nav>
</div>
<!-- main -->
<main class="content" id="quarto-document-content">
<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title">Deployment Procedures</h1>
</div>
<div>
<div class="description">
    Step-by-step guide for deploying the ModernMath Knowledge Graph system
  </div>
</div>
<div class="quarto-title-meta">
</div>
</header>
<section class="level1" data-number="1" id="overview">
<h1 data-number="1"><span class="header-section-number">1</span> Overview</h1>
<p>This guide provides detailed procedures for deploying the ModernMath Knowledge Graph system, including both development and production deployments. The system consists of several components that need to be deployed in the correct order.</p>
<section class="level2" data-number="1.1" id="deployment-components">
<h2 class="anchored" data-anchor-id="deployment-components" data-number="1.1"><span class="header-section-number">1.1</span> Deployment Components</h2>
<ol type="1">
<li><strong>Static Website</strong> (GitHub Pages)</li>
<li><strong>SPARQL Endpoint</strong> (Apache Jena Fuseki)</li>
<li><strong>REST API</strong> (Flask Application)</li>
<li><strong>Knowledge Graph Data</strong> (RDF Triple Store)</li>
</ol>
</section>
</section>
<section class="level1" data-number="2" id="prerequisites">
<h1 data-number="2"><span class="header-section-number">2</span> Prerequisites</h1>
<section class="level2" data-number="2.1" id="system-requirements">
<h2 class="anchored" data-anchor-id="system-requirements" data-number="2.1"><span class="header-section-number">2.1</span> System Requirements</h2>
<section class="level3" data-number="2.1.1" id="development-environment">
<h3 class="anchored" data-anchor-id="development-environment" data-number="2.1.1"><span class="header-section-number">2.1.1</span> Development Environment</h3>
<ul>
<li><strong>OS</strong>: macOS, Linux, or Windows with WSL</li>
<li><strong>Python</strong>: 3.11 or higher</li>
<li><strong>Node.js</strong>: 16.x or higher</li>
<li><strong>Java</strong>: JDK 11+ (for Fuseki)</li>
<li><strong>Git</strong>: 2.x or higher</li>
<li><strong>Poetry</strong>: 1.4 or higher</li>
<li><strong>Quarto</strong>: 1.4 or higher</li>
</ul>
</section>
<section class="level3" data-number="2.1.2" id="production-environment">
<h3 class="anchored" data-anchor-id="production-environment" data-number="2.1.2"><span class="header-section-number">2.1.2</span> Production Environment</h3>
<ul>
<li><strong>Server</strong>: Ubuntu 20.04+ or similar</li>
<li><strong>RAM</strong>: Minimum 4GB, recommended 8GB+</li>
<li><strong>Storage</strong>: 20GB+ depending on graph size</li>
<li><strong>Ports</strong>: 80/443 (web), 3030 (Fuseki), 5001 (API)</li>
</ul>
</section>
</section>
<section class="level2" data-number="2.2" id="required-accounts">
<h2 class="anchored" data-anchor-id="required-accounts" data-number="2.2"><span class="header-section-number">2.2</span> Required Accounts</h2>
<ul>
<li>GitHub account with repository access</li>
<li>Domain name (optional for custom domain)</li>
<li>Cloud provider account (if not self-hosting)</li>
</ul>
</section>
</section>
<section class="level1" data-number="3" id="local-development-deployment">
<h1 data-number="3"><span class="header-section-number">3</span> Local Development Deployment</h1>
<section class="level2" data-number="3.1" id="step-1-clone-and-setup-repository">
<h2 class="anchored" data-anchor-id="step-1-clone-and-setup-repository" data-number="3.1"><span class="header-section-number">3.1</span> Step 1: Clone and Setup Repository</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="co"># Clone the repository</span></span>
<span id="cb1-2"><a aria-hidden="true" href="#cb1-2" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/YOUR_USERNAME/ModernMath.git</span>
<span id="cb1-3"><a aria-hidden="true" href="#cb1-3" tabindex="-1"></a><span class="bu">cd</span> ModernMath</span>
<span id="cb1-4"><a aria-hidden="true" href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a aria-hidden="true" href="#cb1-5" tabindex="-1"></a><span class="co"># Install Poetry if not already installed</span></span>
<span id="cb1-6"><a aria-hidden="true" href="#cb1-6" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sSL</span> https://install.python-poetry.org <span class="kw">|</span> <span class="ex">python3</span> <span class="at">-</span></span>
<span id="cb1-7"><a aria-hidden="true" href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a aria-hidden="true" href="#cb1-8" tabindex="-1"></a><span class="co"># Install Python dependencies</span></span>
<span id="cb1-9"><a aria-hidden="true" href="#cb1-9" tabindex="-1"></a><span class="ex">poetry</span> install</span>
<span id="cb1-10"><a aria-hidden="true" href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a aria-hidden="true" href="#cb1-11" tabindex="-1"></a><span class="co"># Activate the virtual environment</span></span>
<span id="cb1-12"><a aria-hidden="true" href="#cb1-12" tabindex="-1"></a><span class="ex">poetry</span> shell</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level2" data-number="3.2" id="step-2-build-the-knowledge-graph">
<h2 class="anchored" data-anchor-id="step-2-build-the-knowledge-graph" data-number="3.2"><span class="header-section-number">3.2</span> Step 2: Build the Knowledge Graph</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a><span class="co"># Validate all content</span></span>
<span id="cb2-2"><a aria-hidden="true" href="#cb2-2" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/validate_metadata.py</span>
<span id="cb2-3"><a aria-hidden="true" href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a aria-hidden="true" href="#cb2-4" tabindex="-1"></a><span class="co"># Build the RDF knowledge graph</span></span>
<span id="cb2-5"><a aria-hidden="true" href="#cb2-5" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/build_graph.py</span>
<span id="cb2-6"><a aria-hidden="true" href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a aria-hidden="true" href="#cb2-7" tabindex="-1"></a><span class="co"># Validate the generated graph</span></span>
<span id="cb2-8"><a aria-hidden="true" href="#cb2-8" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/validate_graph.py</span>
<span id="cb2-9"><a aria-hidden="true" href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a aria-hidden="true" href="#cb2-10" tabindex="-1"></a><span class="co"># Generate visualizations</span></span>
<span id="cb2-11"><a aria-hidden="true" href="#cb2-11" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_mermaid.py</span>
<span id="cb2-12"><a aria-hidden="true" href="#cb2-12" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_pyvis.py</span>
<span id="cb2-13"><a aria-hidden="true" href="#cb2-13" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_d3_data.py</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level2" data-number="3.3" id="step-3-start-backend-services">
<h2 class="anchored" data-anchor-id="step-3-start-backend-services" data-number="3.3"><span class="header-section-number">3.3</span> Step 3: Start Backend Services</h2>
<section class="level3" data-number="3.3.1" id="start-fuseki-sparql-endpoint">
<h3 class="anchored" data-anchor-id="start-fuseki-sparql-endpoint" data-number="3.3.1"><span class="header-section-number">3.3.1</span> Start Fuseki SPARQL Endpoint</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="co"># Navigate to Fuseki directory</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a><span class="bu">cd</span> fuseki/scripts</span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a><span class="co"># Start Fuseki server</span></span>
<span id="cb3-5"><a aria-hidden="true" href="#cb3-5" tabindex="-1"></a><span class="ex">./start_fuseki.sh</span></span>
<span id="cb3-6"><a aria-hidden="true" href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a aria-hidden="true" href="#cb3-7" tabindex="-1"></a><span class="co"># Or start with memory-only storage (for testing)</span></span>
<span id="cb3-8"><a aria-hidden="true" href="#cb3-8" tabindex="-1"></a><span class="ex">./start_fuseki_memory.sh</span></span>
<span id="cb3-9"><a aria-hidden="true" href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a aria-hidden="true" href="#cb3-10" tabindex="-1"></a><span class="co"># Verify Fuseki is running</span></span>
<span id="cb3-11"><a aria-hidden="true" href="#cb3-11" tabindex="-1"></a><span class="ex">curl</span> http://localhost:3030/$/ping</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="3.3.2" id="load-data-into-fuseki">
<h3 class="anchored" data-anchor-id="load-data-into-fuseki" data-number="3.3.2"><span class="header-section-number">3.3.2</span> Load Data into Fuseki</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a><span class="co"># Load the knowledge graph</span></span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a><span class="ex">./load_data.sh</span></span>
<span id="cb4-3"><a aria-hidden="true" href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a aria-hidden="true" href="#cb4-4" tabindex="-1"></a><span class="co"># Verify data is loaded</span></span>
<span id="cb4-5"><a aria-hidden="true" href="#cb4-5" tabindex="-1"></a><span class="bu">cd</span> ../../</span>
<span id="cb4-6"><a aria-hidden="true" href="#cb4-6" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/test_queries.py</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="3.3.3" id="start-flask-api">
<h3 class="anchored" data-anchor-id="start-flask-api" data-number="3.3.3"><span class="header-section-number">3.3.3</span> Start Flask API</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a aria-hidden="true" href="#cb5-1" tabindex="-1"></a><span class="co"># In a new terminal, navigate to API directory</span></span>
<span id="cb5-2"><a aria-hidden="true" href="#cb5-2" tabindex="-1"></a><span class="bu">cd</span> api</span>
<span id="cb5-3"><a aria-hidden="true" href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a aria-hidden="true" href="#cb5-4" tabindex="-1"></a><span class="co"># Start the API server</span></span>
<span id="cb5-5"><a aria-hidden="true" href="#cb5-5" tabindex="-1"></a><span class="ex">./start_api.sh</span></span>
<span id="cb5-6"><a aria-hidden="true" href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a aria-hidden="true" href="#cb5-7" tabindex="-1"></a><span class="co"># Or run directly with Poetry</span></span>
<span id="cb5-8"><a aria-hidden="true" href="#cb5-8" tabindex="-1"></a><span class="ex">poetry</span> run python app.py</span>
<span id="cb5-9"><a aria-hidden="true" href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a aria-hidden="true" href="#cb5-10" tabindex="-1"></a><span class="co"># Verify API is running</span></span>
<span id="cb5-11"><a aria-hidden="true" href="#cb5-11" tabindex="-1"></a><span class="ex">curl</span> http://localhost:5001/api/health</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level2" data-number="3.4" id="step-4-build-and-preview-website">
<h2 class="anchored" data-anchor-id="step-4-build-and-preview-website" data-number="3.4"><span class="header-section-number">3.4</span> Step 4: Build and Preview Website</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1" tabindex="-1"></a><span class="co"># Return to project root</span></span>
<span id="cb6-2"><a aria-hidden="true" href="#cb6-2" tabindex="-1"></a><span class="bu">cd</span> ..</span>
<span id="cb6-3"><a aria-hidden="true" href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a aria-hidden="true" href="#cb6-4" tabindex="-1"></a><span class="co"># Build the Quarto website</span></span>
<span id="cb6-5"><a aria-hidden="true" href="#cb6-5" tabindex="-1"></a><span class="ex">quarto</span> render</span>
<span id="cb6-6"><a aria-hidden="true" href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a aria-hidden="true" href="#cb6-7" tabindex="-1"></a><span class="co"># Preview locally</span></span>
<span id="cb6-8"><a aria-hidden="true" href="#cb6-8" tabindex="-1"></a><span class="ex">quarto</span> preview</span>
<span id="cb6-9"><a aria-hidden="true" href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a aria-hidden="true" href="#cb6-10" tabindex="-1"></a><span class="co"># Website will be available at http://localhost:4000</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level1" data-number="4" id="github-pages-deployment">
<h1 data-number="4"><span class="header-section-number">4</span> GitHub Pages Deployment</h1>
<section class="level2" data-number="4.1" id="step-1-configure-repository">
<h2 class="anchored" data-anchor-id="step-1-configure-repository" data-number="4.1"><span class="header-section-number">4.1</span> Step 1: Configure Repository</h2>
<ol type="1">
<li>Go to repository Settings ‚Üí Pages</li>
<li>Set Source to ‚ÄúGitHub Actions‚Äù</li>
<li>Ensure repository visibility allows GitHub Pages</li>
</ol>
</section>
<section class="level2" data-number="4.2" id="step-2-setup-github-actions">
<h2 class="anchored" data-anchor-id="step-2-setup-github-actions" data-number="4.2"><span class="header-section-number">4.2</span> Step 2: Setup GitHub Actions</h2>
<p>The repository includes <code>.github/workflows/deploy.yml</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Deploy to GitHub Pages</span></span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a aria-hidden="true" href="#cb7-3" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb7-4"><a aria-hidden="true" href="#cb7-4" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb7-5"><a aria-hidden="true" href="#cb7-5" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">main</span><span class="kw">]</span></span>
<span id="cb7-6"><a aria-hidden="true" href="#cb7-6" tabindex="-1"></a><span class="at">  </span><span class="fu">pull_request</span><span class="kw">:</span></span>
<span id="cb7-7"><a aria-hidden="true" href="#cb7-7" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">main</span><span class="kw">]</span></span>
<span id="cb7-8"><a aria-hidden="true" href="#cb7-8" tabindex="-1"></a><span class="at">  </span><span class="fu">workflow_dispatch</span><span class="kw">:</span></span>
<span id="cb7-9"><a aria-hidden="true" href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a aria-hidden="true" href="#cb7-10" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb7-11"><a aria-hidden="true" href="#cb7-11" tabindex="-1"></a><span class="at">  </span><span class="fu">build-and-deploy</span><span class="kw">:</span></span>
<span id="cb7-12"><a aria-hidden="true" href="#cb7-12" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb7-13"><a aria-hidden="true" href="#cb7-13" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb7-14"><a aria-hidden="true" href="#cb7-14" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span>
<span id="cb7-15"><a aria-hidden="true" href="#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a aria-hidden="true" href="#cb7-16" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Set up Python</span></span>
<span id="cb7-17"><a aria-hidden="true" href="#cb7-17" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-python@v4</span></span>
<span id="cb7-18"><a aria-hidden="true" href="#cb7-18" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb7-19"><a aria-hidden="true" href="#cb7-19" tabindex="-1"></a><span class="at">          </span><span class="fu">python-version</span><span class="kw">:</span><span class="at"> </span><span class="st">'3.11'</span></span>
<span id="cb7-20"><a aria-hidden="true" href="#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a aria-hidden="true" href="#cb7-21" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install Poetry</span></span>
<span id="cb7-22"><a aria-hidden="true" href="#cb7-22" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> snok/install-poetry@v1</span></span>
<span id="cb7-23"><a aria-hidden="true" href="#cb7-23" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb7-24"><a aria-hidden="true" href="#cb7-24" tabindex="-1"></a><span class="at">          </span><span class="fu">version</span><span class="kw">:</span><span class="at"> latest</span></span>
<span id="cb7-25"><a aria-hidden="true" href="#cb7-25" tabindex="-1"></a><span class="at">          </span><span class="fu">virtualenvs-create</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb7-26"><a aria-hidden="true" href="#cb7-26" tabindex="-1"></a><span class="at">          </span><span class="fu">virtualenvs-in-project</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb7-27"><a aria-hidden="true" href="#cb7-27" tabindex="-1"></a></span>
<span id="cb7-28"><a aria-hidden="true" href="#cb7-28" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install dependencies</span></span>
<span id="cb7-29"><a aria-hidden="true" href="#cb7-29" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> poetry install</span></span>
<span id="cb7-30"><a aria-hidden="true" href="#cb7-30" tabindex="-1"></a></span>
<span id="cb7-31"><a aria-hidden="true" href="#cb7-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Build knowledge graph</span></span>
<span id="cb7-32"><a aria-hidden="true" href="#cb7-32" tabindex="-1"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb7-33"><a aria-hidden="true" href="#cb7-33" tabindex="-1"></a>          poetry run python scripts/validate_metadata.py</span>
<span id="cb7-34"><a aria-hidden="true" href="#cb7-34" tabindex="-1"></a>          poetry run python scripts/build_graph.py</span>
<span id="cb7-35"><a aria-hidden="true" href="#cb7-35" tabindex="-1"></a>          poetry run python scripts/generate_mermaid.py</span>
<span id="cb7-36"><a aria-hidden="true" href="#cb7-36" tabindex="-1"></a>          poetry run python scripts/generate_pyvis.py</span>
<span id="cb7-37"><a aria-hidden="true" href="#cb7-37" tabindex="-1"></a>          poetry run python scripts/generate_d3_data.py</span>
<span id="cb7-38"><a aria-hidden="true" href="#cb7-38" tabindex="-1"></a></span>
<span id="cb7-39"><a aria-hidden="true" href="#cb7-39" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Setup Quarto</span></span>
<span id="cb7-40"><a aria-hidden="true" href="#cb7-40" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> quarto-dev/quarto-actions/setup@v2</span></span>
<span id="cb7-41"><a aria-hidden="true" href="#cb7-41" tabindex="-1"></a></span>
<span id="cb7-42"><a aria-hidden="true" href="#cb7-42" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Render Quarto site</span></span>
<span id="cb7-43"><a aria-hidden="true" href="#cb7-43" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> quarto render</span></span>
<span id="cb7-44"><a aria-hidden="true" href="#cb7-44" tabindex="-1"></a></span>
<span id="cb7-45"><a aria-hidden="true" href="#cb7-45" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Upload artifact</span></span>
<span id="cb7-46"><a aria-hidden="true" href="#cb7-46" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-pages-artifact@v2</span></span>
<span id="cb7-47"><a aria-hidden="true" href="#cb7-47" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb7-48"><a aria-hidden="true" href="#cb7-48" tabindex="-1"></a><span class="at">          </span><span class="fu">path</span><span class="kw">:</span><span class="at"> _site</span></span>
<span id="cb7-49"><a aria-hidden="true" href="#cb7-49" tabindex="-1"></a></span>
<span id="cb7-50"><a aria-hidden="true" href="#cb7-50" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Deploy to GitHub Pages</span></span>
<span id="cb7-51"><a aria-hidden="true" href="#cb7-51" tabindex="-1"></a><span class="at">        </span><span class="fu">if</span><span class="kw">:</span><span class="at"> github.ref == 'refs/heads/main'</span></span>
<span id="cb7-52"><a aria-hidden="true" href="#cb7-52" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/deploy-pages@v2</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level2" data-number="4.3" id="step-3-trigger-deployment">
<h2 class="anchored" data-anchor-id="step-3-trigger-deployment" data-number="4.3"><span class="header-section-number">4.3</span> Step 3: Trigger Deployment</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a aria-hidden="true" href="#cb8-1" tabindex="-1"></a><span class="co"># Commit and push changes</span></span>
<span id="cb8-2"><a aria-hidden="true" href="#cb8-2" tabindex="-1"></a><span class="fu">git</span> add .</span>
<span id="cb8-3"><a aria-hidden="true" href="#cb8-3" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"Deploy to GitHub Pages"</span></span>
<span id="cb8-4"><a aria-hidden="true" href="#cb8-4" tabindex="-1"></a><span class="fu">git</span> push origin main</span>
<span id="cb8-5"><a aria-hidden="true" href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a aria-hidden="true" href="#cb8-6" tabindex="-1"></a><span class="co"># Monitor deployment</span></span>
<span id="cb8-7"><a aria-hidden="true" href="#cb8-7" tabindex="-1"></a><span class="co"># Go to Actions tab in GitHub repository</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level2" data-number="4.4" id="step-4-verify-deployment">
<h2 class="anchored" data-anchor-id="step-4-verify-deployment" data-number="4.4"><span class="header-section-number">4.4</span> Step 4: Verify Deployment</h2>
<ol type="1">
<li>Wait for GitHub Actions to complete</li>
<li>Visit <code>https://YOUR_USERNAME.github.io/ModernMath</code></li>
<li>Check visualizations are loading</li>
<li>Verify all pages render correctly</li>
</ol>
</section>
</section>
<section class="level1" data-number="5" id="production-server-deployment">
<h1 data-number="5"><span class="header-section-number">5</span> Production Server Deployment</h1>
<section class="level2" data-number="5.1" id="step-1-server-preparation">
<h2 class="anchored" data-anchor-id="step-1-server-preparation" data-number="5.1"><span class="header-section-number">5.1</span> Step 1: Server Preparation</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a aria-hidden="true" href="#cb9-1" tabindex="-1"></a><span class="co"># Update system</span></span>
<span id="cb9-2"><a aria-hidden="true" href="#cb9-2" tabindex="-1"></a><span class="fu">sudo</span> apt update <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> apt upgrade <span class="at">-y</span></span>
<span id="cb9-3"><a aria-hidden="true" href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a aria-hidden="true" href="#cb9-4" tabindex="-1"></a><span class="co"># Install required packages</span></span>
<span id="cb9-5"><a aria-hidden="true" href="#cb9-5" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="at">-y</span> python3.11 python3.11-venv python3-pip</span>
<span id="cb9-6"><a aria-hidden="true" href="#cb9-6" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="at">-y</span> nodejs npm</span>
<span id="cb9-7"><a aria-hidden="true" href="#cb9-7" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="at">-y</span> nginx</span>
<span id="cb9-8"><a aria-hidden="true" href="#cb9-8" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="at">-y</span> default-jdk</span>
<span id="cb9-9"><a aria-hidden="true" href="#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a aria-hidden="true" href="#cb9-10" tabindex="-1"></a><span class="co"># Install Poetry</span></span>
<span id="cb9-11"><a aria-hidden="true" href="#cb9-11" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sSL</span> https://install.python-poetry.org <span class="kw">|</span> <span class="ex">python3</span> <span class="at">-</span></span>
<span id="cb9-12"><a aria-hidden="true" href="#cb9-12" tabindex="-1"></a></span>
<span id="cb9-13"><a aria-hidden="true" href="#cb9-13" tabindex="-1"></a><span class="co"># Install Quarto</span></span>
<span id="cb9-14"><a aria-hidden="true" href="#cb9-14" tabindex="-1"></a><span class="fu">wget</span> https://github.com/quarto-dev/quarto-cli/releases/download/v1.4.0/quarto-1.4.0-linux-amd64.deb</span>
<span id="cb9-15"><a aria-hidden="true" href="#cb9-15" tabindex="-1"></a><span class="fu">sudo</span> dpkg <span class="at">-i</span> quarto-1.4.0-linux-amd64.deb</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level2" data-number="5.2" id="step-2-clone-and-setup-application">
<h2 class="anchored" data-anchor-id="step-2-clone-and-setup-application" data-number="5.2"><span class="header-section-number">5.2</span> Step 2: Clone and Setup Application</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a aria-hidden="true" href="#cb10-1" tabindex="-1"></a><span class="co"># Create application directory</span></span>
<span id="cb10-2"><a aria-hidden="true" href="#cb10-2" tabindex="-1"></a><span class="fu">sudo</span> mkdir <span class="at">-p</span> /opt/modernmath</span>
<span id="cb10-3"><a aria-hidden="true" href="#cb10-3" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="va">$USER</span>:<span class="va">$USER</span> /opt/modernmath</span>
<span id="cb10-4"><a aria-hidden="true" href="#cb10-4" tabindex="-1"></a><span class="bu">cd</span> /opt/modernmath</span>
<span id="cb10-5"><a aria-hidden="true" href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a aria-hidden="true" href="#cb10-6" tabindex="-1"></a><span class="co"># Clone repository</span></span>
<span id="cb10-7"><a aria-hidden="true" href="#cb10-7" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/YOUR_USERNAME/ModernMath.git .</span>
<span id="cb10-8"><a aria-hidden="true" href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a aria-hidden="true" href="#cb10-9" tabindex="-1"></a><span class="co"># Install dependencies</span></span>
<span id="cb10-10"><a aria-hidden="true" href="#cb10-10" tabindex="-1"></a><span class="ex">poetry</span> install <span class="at">--no-dev</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level2" data-number="5.3" id="step-3-configure-fuseki-service">
<h2 class="anchored" data-anchor-id="step-3-configure-fuseki-service" data-number="5.3"><span class="header-section-number">5.3</span> Step 3: Configure Fuseki Service</h2>
<section class="level3" data-number="5.3.1" id="create-systemd-service">
<h3 class="anchored" data-anchor-id="create-systemd-service" data-number="5.3.1"><span class="header-section-number">5.3.1</span> Create Systemd Service</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/systemd/system/fuseki.service</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode ini code-with-copy"><code class="sourceCode ini"><span id="cb12-1"><a aria-hidden="true" href="#cb12-1" tabindex="-1"></a><span class="kw">[Unit]</span></span>
<span id="cb12-2"><a aria-hidden="true" href="#cb12-2" tabindex="-1"></a><span class="dt">Description</span><span class="ot">=</span><span class="st">Apache Jena Fuseki</span></span>
<span id="cb12-3"><a aria-hidden="true" href="#cb12-3" tabindex="-1"></a><span class="dt">After</span><span class="ot">=</span><span class="st">network.target</span></span>
<span id="cb12-4"><a aria-hidden="true" href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a aria-hidden="true" href="#cb12-5" tabindex="-1"></a><span class="kw">[Service]</span></span>
<span id="cb12-6"><a aria-hidden="true" href="#cb12-6" tabindex="-1"></a><span class="dt">Type</span><span class="ot">=</span><span class="st">simple</span></span>
<span id="cb12-7"><a aria-hidden="true" href="#cb12-7" tabindex="-1"></a><span class="dt">User</span><span class="ot">=</span><span class="st">fuseki</span></span>
<span id="cb12-8"><a aria-hidden="true" href="#cb12-8" tabindex="-1"></a><span class="dt">Group</span><span class="ot">=</span><span class="st">fuseki</span></span>
<span id="cb12-9"><a aria-hidden="true" href="#cb12-9" tabindex="-1"></a><span class="dt">WorkingDirectory</span><span class="ot">=</span><span class="st">/opt/modernmath/fuseki/fuseki-server/apache-jena-fuseki-4.10.0</span></span>
<span id="cb12-10"><a aria-hidden="true" href="#cb12-10" tabindex="-1"></a><span class="dt">ExecStart</span><span class="ot">=</span><span class="st">/opt/modernmath/fuseki/fuseki-server/apache-jena-fuseki-4.10.0/fuseki-server --port=3030 --tdb2 --loc=/opt/modernmath/fuseki/data /mathwiki</span></span>
<span id="cb12-11"><a aria-hidden="true" href="#cb12-11" tabindex="-1"></a><span class="dt">Restart</span><span class="ot">=</span><span class="st">on-failure</span></span>
<span id="cb12-12"><a aria-hidden="true" href="#cb12-12" tabindex="-1"></a><span class="dt">RestartSec</span><span class="ot">=</span><span class="dv">10</span></span>
<span id="cb12-13"><a aria-hidden="true" href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a aria-hidden="true" href="#cb12-14" tabindex="-1"></a><span class="kw">[Install]</span></span>
<span id="cb12-15"><a aria-hidden="true" href="#cb12-15" tabindex="-1"></a><span class="dt">WantedBy</span><span class="ot">=</span><span class="st">multi-user.target</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="5.3.2" id="start-fuseki">
<h3 class="anchored" data-anchor-id="start-fuseki" data-number="5.3.2"><span class="header-section-number">5.3.2</span> Start Fuseki</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a><span class="co"># Create fuseki user</span></span>
<span id="cb13-2"><a aria-hidden="true" href="#cb13-2" tabindex="-1"></a><span class="fu">sudo</span> useradd <span class="at">-r</span> <span class="at">-s</span> /bin/false fuseki</span>
<span id="cb13-3"><a aria-hidden="true" href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a aria-hidden="true" href="#cb13-4" tabindex="-1"></a><span class="co"># Set permissions</span></span>
<span id="cb13-5"><a aria-hidden="true" href="#cb13-5" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> fuseki:fuseki /opt/modernmath/fuseki</span>
<span id="cb13-6"><a aria-hidden="true" href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a aria-hidden="true" href="#cb13-7" tabindex="-1"></a><span class="co"># Enable and start service</span></span>
<span id="cb13-8"><a aria-hidden="true" href="#cb13-8" tabindex="-1"></a><span class="fu">sudo</span> systemctl enable fuseki</span>
<span id="cb13-9"><a aria-hidden="true" href="#cb13-9" tabindex="-1"></a><span class="fu">sudo</span> systemctl start fuseki</span>
<span id="cb13-10"><a aria-hidden="true" href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a aria-hidden="true" href="#cb13-11" tabindex="-1"></a><span class="co"># Check status</span></span>
<span id="cb13-12"><a aria-hidden="true" href="#cb13-12" tabindex="-1"></a><span class="fu">sudo</span> systemctl status fuseki</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level2" data-number="5.4" id="step-4-configure-flask-api-service">
<h2 class="anchored" data-anchor-id="step-4-configure-flask-api-service" data-number="5.4"><span class="header-section-number">5.4</span> Step 4: Configure Flask API Service</h2>
<section class="level3" data-number="5.4.1" id="create-systemd-service-1">
<h3 class="anchored" data-anchor-id="create-systemd-service-1" data-number="5.4.1"><span class="header-section-number">5.4.1</span> Create Systemd Service</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a aria-hidden="true" href="#cb14-1" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/systemd/system/mathwiki-api.service</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode ini code-with-copy"><code class="sourceCode ini"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a><span class="kw">[Unit]</span></span>
<span id="cb15-2"><a aria-hidden="true" href="#cb15-2" tabindex="-1"></a><span class="dt">Description</span><span class="ot">=</span><span class="st">MathWiki REST API</span></span>
<span id="cb15-3"><a aria-hidden="true" href="#cb15-3" tabindex="-1"></a><span class="dt">After</span><span class="ot">=</span><span class="st">network.target fuseki.service</span></span>
<span id="cb15-4"><a aria-hidden="true" href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a aria-hidden="true" href="#cb15-5" tabindex="-1"></a><span class="kw">[Service]</span></span>
<span id="cb15-6"><a aria-hidden="true" href="#cb15-6" tabindex="-1"></a><span class="dt">Type</span><span class="ot">=</span><span class="st">simple</span></span>
<span id="cb15-7"><a aria-hidden="true" href="#cb15-7" tabindex="-1"></a><span class="dt">User</span><span class="ot">=</span><span class="st">www-data</span></span>
<span id="cb15-8"><a aria-hidden="true" href="#cb15-8" tabindex="-1"></a><span class="dt">Group</span><span class="ot">=</span><span class="st">www-data</span></span>
<span id="cb15-9"><a aria-hidden="true" href="#cb15-9" tabindex="-1"></a><span class="dt">WorkingDirectory</span><span class="ot">=</span><span class="st">/opt/modernmath/api</span></span>
<span id="cb15-10"><a aria-hidden="true" href="#cb15-10" tabindex="-1"></a><span class="dt">Environment</span><span class="ot">=</span><span class="st">"PATH=/opt/modernmath/.venv/bin"</span></span>
<span id="cb15-11"><a aria-hidden="true" href="#cb15-11" tabindex="-1"></a><span class="dt">ExecStart</span><span class="ot">=</span><span class="st">/opt/modernmath/.venv/bin/python app.py</span></span>
<span id="cb15-12"><a aria-hidden="true" href="#cb15-12" tabindex="-1"></a><span class="dt">Restart</span><span class="ot">=</span><span class="st">on-failure</span></span>
<span id="cb15-13"><a aria-hidden="true" href="#cb15-13" tabindex="-1"></a><span class="dt">RestartSec</span><span class="ot">=</span><span class="dv">10</span></span>
<span id="cb15-14"><a aria-hidden="true" href="#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a aria-hidden="true" href="#cb15-15" tabindex="-1"></a><span class="kw">[Install]</span></span>
<span id="cb15-16"><a aria-hidden="true" href="#cb15-16" tabindex="-1"></a><span class="dt">WantedBy</span><span class="ot">=</span><span class="st">multi-user.target</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="5.4.2" id="start-api-service">
<h3 class="anchored" data-anchor-id="start-api-service" data-number="5.4.2"><span class="header-section-number">5.4.2</span> Start API Service</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a aria-hidden="true" href="#cb16-1" tabindex="-1"></a><span class="co"># Set permissions</span></span>
<span id="cb16-2"><a aria-hidden="true" href="#cb16-2" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> www-data:www-data /opt/modernmath/api</span>
<span id="cb16-3"><a aria-hidden="true" href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a aria-hidden="true" href="#cb16-4" tabindex="-1"></a><span class="co"># Enable and start service</span></span>
<span id="cb16-5"><a aria-hidden="true" href="#cb16-5" tabindex="-1"></a><span class="fu">sudo</span> systemctl enable mathwiki-api</span>
<span id="cb16-6"><a aria-hidden="true" href="#cb16-6" tabindex="-1"></a><span class="fu">sudo</span> systemctl start mathwiki-api</span>
<span id="cb16-7"><a aria-hidden="true" href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a aria-hidden="true" href="#cb16-8" tabindex="-1"></a><span class="co"># Check status</span></span>
<span id="cb16-9"><a aria-hidden="true" href="#cb16-9" tabindex="-1"></a><span class="fu">sudo</span> systemctl status mathwiki-api</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level2" data-number="5.5" id="step-5-configure-nginx">
<h2 class="anchored" data-anchor-id="step-5-configure-nginx" data-number="5.5"><span class="header-section-number">5.5</span> Step 5: Configure Nginx</h2>
<section class="level3" data-number="5.5.1" id="create-nginx-configuration">
<h3 class="anchored" data-anchor-id="create-nginx-configuration" data-number="5.5.1"><span class="header-section-number">5.5.1</span> Create Nginx Configuration</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/nginx/sites-available/modernmath</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
<pre class="nginx"><code>server {
    listen 80;
    server_name your-domain.com;

    # Redirect to HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;

    # SSL configuration (update paths)
    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;

    # Static website
    root /opt/modernmath/_site;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }

    # API proxy
    location /api/ {
        proxy_pass http://localhost:5001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # SPARQL endpoint proxy
    location /sparql/ {
        proxy_pass http://localhost:3030/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}</code></pre>
</section>
<section class="level3" data-number="5.5.2" id="enable-site">
<h3 class="anchored" data-anchor-id="enable-site" data-number="5.5.2"><span class="header-section-number">5.5.2</span> Enable Site</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a aria-hidden="true" href="#cb19-1" tabindex="-1"></a><span class="co"># Enable site</span></span>
<span id="cb19-2"><a aria-hidden="true" href="#cb19-2" tabindex="-1"></a><span class="fu">sudo</span> ln <span class="at">-s</span> /etc/nginx/sites-available/modernmath /etc/nginx/sites-enabled/</span>
<span id="cb19-3"><a aria-hidden="true" href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a aria-hidden="true" href="#cb19-4" tabindex="-1"></a><span class="co"># Test configuration</span></span>
<span id="cb19-5"><a aria-hidden="true" href="#cb19-5" tabindex="-1"></a><span class="fu">sudo</span> nginx <span class="at">-t</span></span>
<span id="cb19-6"><a aria-hidden="true" href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a aria-hidden="true" href="#cb19-7" tabindex="-1"></a><span class="co"># Reload Nginx</span></span>
<span id="cb19-8"><a aria-hidden="true" href="#cb19-8" tabindex="-1"></a><span class="fu">sudo</span> systemctl reload nginx</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level2" data-number="5.6" id="step-6-setup-ssl-with-lets-encrypt">
<h2 class="anchored" data-anchor-id="step-6-setup-ssl-with-lets-encrypt" data-number="5.6"><span class="header-section-number">5.6</span> Step 6: Setup SSL with Let‚Äôs Encrypt</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a aria-hidden="true" href="#cb20-1" tabindex="-1"></a><span class="co"># Install Certbot</span></span>
<span id="cb20-2"><a aria-hidden="true" href="#cb20-2" tabindex="-1"></a><span class="fu">sudo</span> apt install certbot python3-certbot-nginx</span>
<span id="cb20-3"><a aria-hidden="true" href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a aria-hidden="true" href="#cb20-4" tabindex="-1"></a><span class="co"># Obtain certificate</span></span>
<span id="cb20-5"><a aria-hidden="true" href="#cb20-5" tabindex="-1"></a><span class="fu">sudo</span> certbot <span class="at">--nginx</span> <span class="at">-d</span> your-domain.com</span>
<span id="cb20-6"><a aria-hidden="true" href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a aria-hidden="true" href="#cb20-7" tabindex="-1"></a><span class="co"># Test auto-renewal</span></span>
<span id="cb20-8"><a aria-hidden="true" href="#cb20-8" tabindex="-1"></a><span class="fu">sudo</span> certbot renew <span class="at">--dry-run</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level2" data-number="5.7" id="step-7-deploy-website-content">
<h2 class="anchored" data-anchor-id="step-7-deploy-website-content" data-number="5.7"><span class="header-section-number">5.7</span> Step 7: Deploy Website Content</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a><span class="bu">cd</span> /opt/modernmath</span>
<span id="cb21-2"><a aria-hidden="true" href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a aria-hidden="true" href="#cb21-3" tabindex="-1"></a><span class="co"># Build knowledge graph</span></span>
<span id="cb21-4"><a aria-hidden="true" href="#cb21-4" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/build_graph.py</span>
<span id="cb21-5"><a aria-hidden="true" href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a aria-hidden="true" href="#cb21-6" tabindex="-1"></a><span class="co"># Generate all visualizations</span></span>
<span id="cb21-7"><a aria-hidden="true" href="#cb21-7" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_mermaid.py</span>
<span id="cb21-8"><a aria-hidden="true" href="#cb21-8" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_pyvis.py</span>
<span id="cb21-9"><a aria-hidden="true" href="#cb21-9" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_d3_data.py</span>
<span id="cb21-10"><a aria-hidden="true" href="#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a aria-hidden="true" href="#cb21-11" tabindex="-1"></a><span class="co"># Build website</span></span>
<span id="cb21-12"><a aria-hidden="true" href="#cb21-12" tabindex="-1"></a><span class="ex">quarto</span> render</span>
<span id="cb21-13"><a aria-hidden="true" href="#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a aria-hidden="true" href="#cb21-14" tabindex="-1"></a><span class="co"># Load data into Fuseki</span></span>
<span id="cb21-15"><a aria-hidden="true" href="#cb21-15" tabindex="-1"></a><span class="bu">cd</span> fuseki/scripts</span>
<span id="cb21-16"><a aria-hidden="true" href="#cb21-16" tabindex="-1"></a><span class="ex">./load_data.sh</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level1" data-number="6" id="continuous-deployment-setup">
<h1 data-number="6"><span class="header-section-number">6</span> Continuous Deployment Setup</h1>
<section class="level2" data-number="6.1" id="github-actions-for-auto-deploy">
<h2 class="anchored" data-anchor-id="github-actions-for-auto-deploy" data-number="6.1"><span class="header-section-number">6.1</span> GitHub Actions for Auto-Deploy</h2>
<section class="level3" data-number="6.1.1" id="create-deploy-script">
<h3 class="anchored" data-anchor-id="create-deploy-script" data-number="6.1.1"><span class="header-section-number">6.1.1</span> Create Deploy Script</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a aria-hidden="true" href="#cb22-1" tabindex="-1"></a><span class="fu">nano</span> /opt/modernmath/deploy.sh</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb23-2"><a aria-hidden="true" href="#cb23-2" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb23-3"><a aria-hidden="true" href="#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a aria-hidden="true" href="#cb23-4" tabindex="-1"></a><span class="bu">cd</span> /opt/modernmath</span>
<span id="cb23-5"><a aria-hidden="true" href="#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a aria-hidden="true" href="#cb23-6" tabindex="-1"></a><span class="co"># Pull latest changes</span></span>
<span id="cb23-7"><a aria-hidden="true" href="#cb23-7" tabindex="-1"></a><span class="fu">git</span> pull origin main</span>
<span id="cb23-8"><a aria-hidden="true" href="#cb23-8" tabindex="-1"></a></span>
<span id="cb23-9"><a aria-hidden="true" href="#cb23-9" tabindex="-1"></a><span class="co"># Install/update dependencies</span></span>
<span id="cb23-10"><a aria-hidden="true" href="#cb23-10" tabindex="-1"></a><span class="ex">poetry</span> install <span class="at">--no-dev</span></span>
<span id="cb23-11"><a aria-hidden="true" href="#cb23-11" tabindex="-1"></a></span>
<span id="cb23-12"><a aria-hidden="true" href="#cb23-12" tabindex="-1"></a><span class="co"># Build knowledge graph</span></span>
<span id="cb23-13"><a aria-hidden="true" href="#cb23-13" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/validate_metadata.py</span>
<span id="cb23-14"><a aria-hidden="true" href="#cb23-14" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/build_graph.py</span>
<span id="cb23-15"><a aria-hidden="true" href="#cb23-15" tabindex="-1"></a></span>
<span id="cb23-16"><a aria-hidden="true" href="#cb23-16" tabindex="-1"></a><span class="co"># Generate visualizations</span></span>
<span id="cb23-17"><a aria-hidden="true" href="#cb23-17" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_mermaid.py</span>
<span id="cb23-18"><a aria-hidden="true" href="#cb23-18" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_pyvis.py</span>
<span id="cb23-19"><a aria-hidden="true" href="#cb23-19" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/generate_d3_data.py</span>
<span id="cb23-20"><a aria-hidden="true" href="#cb23-20" tabindex="-1"></a></span>
<span id="cb23-21"><a aria-hidden="true" href="#cb23-21" tabindex="-1"></a><span class="co"># Build website</span></span>
<span id="cb23-22"><a aria-hidden="true" href="#cb23-22" tabindex="-1"></a><span class="ex">quarto</span> render</span>
<span id="cb23-23"><a aria-hidden="true" href="#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a aria-hidden="true" href="#cb23-24" tabindex="-1"></a><span class="co"># Reload data into Fuseki</span></span>
<span id="cb23-25"><a aria-hidden="true" href="#cb23-25" tabindex="-1"></a><span class="bu">cd</span> fuseki/scripts</span>
<span id="cb23-26"><a aria-hidden="true" href="#cb23-26" tabindex="-1"></a><span class="ex">./load_data.sh</span></span>
<span id="cb23-27"><a aria-hidden="true" href="#cb23-27" tabindex="-1"></a></span>
<span id="cb23-28"><a aria-hidden="true" href="#cb23-28" tabindex="-1"></a><span class="co"># Restart API to pick up changes</span></span>
<span id="cb23-29"><a aria-hidden="true" href="#cb23-29" tabindex="-1"></a><span class="fu">sudo</span> systemctl restart mathwiki-api</span>
<span id="cb23-30"><a aria-hidden="true" href="#cb23-30" tabindex="-1"></a></span>
<span id="cb23-31"><a aria-hidden="true" href="#cb23-31" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Deployment completed successfully"</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a aria-hidden="true" href="#cb24-1" tabindex="-1"></a><span class="fu">chmod</span> +x /opt/modernmath/deploy.sh</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="6.1.2" id="setup-webhook">
<h3 class="anchored" data-anchor-id="setup-webhook" data-number="6.1.2"><span class="header-section-number">6.1.2</span> Setup Webhook</h3>
<p>Use GitHub Webhooks or a CI/CD service to trigger deployment on push to main branch.</p>
</section>
</section>
</section>
<section class="level1" data-number="7" id="monitoring-and-maintenance">
<h1 data-number="7"><span class="header-section-number">7</span> Monitoring and Maintenance</h1>
<section class="level2" data-number="7.1" id="health-checks">
<h2 class="anchored" data-anchor-id="health-checks" data-number="7.1"><span class="header-section-number">7.1</span> Health Checks</h2>
<section class="level3" data-number="7.1.1" id="create-monitoring-script">
<h3 class="anchored" data-anchor-id="create-monitoring-script" data-number="7.1.1"><span class="header-section-number">7.1.1</span> Create Monitoring Script</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a><span class="fu">nano</span> /opt/modernmath/health_check.sh</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a aria-hidden="true" href="#cb26-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb26-2"><a aria-hidden="true" href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a aria-hidden="true" href="#cb26-3" tabindex="-1"></a><span class="co"># Check Fuseki</span></span>
<span id="cb26-4"><a aria-hidden="true" href="#cb26-4" tabindex="-1"></a><span class="cf">if</span> <span class="ot">! </span><span class="ex">curl</span> <span class="at">-s</span> http://localhost:3030/$/ping <span class="op">&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb26-5"><a aria-hidden="true" href="#cb26-5" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"ERROR: Fuseki is not responding"</span></span>
<span id="cb26-6"><a aria-hidden="true" href="#cb26-6" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb26-7"><a aria-hidden="true" href="#cb26-7" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb26-8"><a aria-hidden="true" href="#cb26-8" tabindex="-1"></a></span>
<span id="cb26-9"><a aria-hidden="true" href="#cb26-9" tabindex="-1"></a><span class="co"># Check API</span></span>
<span id="cb26-10"><a aria-hidden="true" href="#cb26-10" tabindex="-1"></a><span class="cf">if</span> <span class="ot">! </span><span class="ex">curl</span> <span class="at">-s</span> http://localhost:5001/api/health <span class="op">&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb26-11"><a aria-hidden="true" href="#cb26-11" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"ERROR: API is not responding"</span></span>
<span id="cb26-12"><a aria-hidden="true" href="#cb26-12" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb26-13"><a aria-hidden="true" href="#cb26-13" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb26-14"><a aria-hidden="true" href="#cb26-14" tabindex="-1"></a></span>
<span id="cb26-15"><a aria-hidden="true" href="#cb26-15" tabindex="-1"></a><span class="co"># Check website</span></span>
<span id="cb26-16"><a aria-hidden="true" href="#cb26-16" tabindex="-1"></a><span class="cf">if</span> <span class="ot">! </span><span class="ex">curl</span> <span class="at">-s</span> http://localhost <span class="op">&gt;</span> /dev/null<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb26-17"><a aria-hidden="true" href="#cb26-17" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"ERROR: Website is not responding"</span></span>
<span id="cb26-18"><a aria-hidden="true" href="#cb26-18" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb26-19"><a aria-hidden="true" href="#cb26-19" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb26-20"><a aria-hidden="true" href="#cb26-20" tabindex="-1"></a></span>
<span id="cb26-21"><a aria-hidden="true" href="#cb26-21" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"All services are healthy"</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="7.1.2" id="setup-cron-job">
<h3 class="anchored" data-anchor-id="setup-cron-job" data-number="7.1.2"><span class="header-section-number">7.1.2</span> Setup Cron Job</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a aria-hidden="true" href="#cb27-1" tabindex="-1"></a><span class="co"># Add to crontab</span></span>
<span id="cb27-2"><a aria-hidden="true" href="#cb27-2" tabindex="-1"></a><span class="fu">crontab</span> <span class="at">-e</span></span>
<span id="cb27-3"><a aria-hidden="true" href="#cb27-3" tabindex="-1"></a></span>
<span id="cb27-4"><a aria-hidden="true" href="#cb27-4" tabindex="-1"></a><span class="co"># Add health check every 5 minutes</span></span>
<span id="cb27-5"><a aria-hidden="true" href="#cb27-5" tabindex="-1"></a><span class="ex">*/5</span> <span class="pp">*</span> <span class="pp">*</span> <span class="pp">*</span> <span class="pp">*</span> /opt/modernmath/health_check.sh <span class="kw">||</span> <span class="ex">systemctl</span> restart fuseki mathwiki-api</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level2" data-number="7.2" id="backup-procedures">
<h2 class="anchored" data-anchor-id="backup-procedures" data-number="7.2"><span class="header-section-number">7.2</span> Backup Procedures</h2>
<section class="level3" data-number="7.2.1" id="daily-backup-script">
<h3 class="anchored" data-anchor-id="daily-backup-script" data-number="7.2.1"><span class="header-section-number">7.2.1</span> Daily Backup Script</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a aria-hidden="true" href="#cb28-1" tabindex="-1"></a><span class="fu">nano</span> /opt/modernmath/backup.sh</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb29-2"><a aria-hidden="true" href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a aria-hidden="true" href="#cb29-3" tabindex="-1"></a><span class="va">BACKUP_DIR</span><span class="op">=</span><span class="st">"/backup/modernmath"</span></span>
<span id="cb29-4"><a aria-hidden="true" href="#cb29-4" tabindex="-1"></a><span class="va">DATE</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> +%Y%m%d_%H%M%S<span class="va">)</span></span>
<span id="cb29-5"><a aria-hidden="true" href="#cb29-5" tabindex="-1"></a></span>
<span id="cb29-6"><a aria-hidden="true" href="#cb29-6" tabindex="-1"></a><span class="co"># Create backup directory</span></span>
<span id="cb29-7"><a aria-hidden="true" href="#cb29-7" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$BACKUP_DIR</span></span>
<span id="cb29-8"><a aria-hidden="true" href="#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a aria-hidden="true" href="#cb29-9" tabindex="-1"></a><span class="co"># Backup RDF data</span></span>
<span id="cb29-10"><a aria-hidden="true" href="#cb29-10" tabindex="-1"></a><span class="fu">cp</span> /opt/modernmath/knowledge_graph.ttl <span class="va">$BACKUP_DIR</span>/knowledge_graph_<span class="va">$DATE</span>.ttl</span>
<span id="cb29-11"><a aria-hidden="true" href="#cb29-11" tabindex="-1"></a></span>
<span id="cb29-12"><a aria-hidden="true" href="#cb29-12" tabindex="-1"></a><span class="co"># Backup Fuseki data</span></span>
<span id="cb29-13"><a aria-hidden="true" href="#cb29-13" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-czf</span> <span class="va">$BACKUP_DIR</span>/fuseki_data_<span class="va">$DATE</span>.tar.gz /opt/modernmath/fuseki/data/</span>
<span id="cb29-14"><a aria-hidden="true" href="#cb29-14" tabindex="-1"></a></span>
<span id="cb29-15"><a aria-hidden="true" href="#cb29-15" tabindex="-1"></a><span class="co"># Backup API logs</span></span>
<span id="cb29-16"><a aria-hidden="true" href="#cb29-16" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-czf</span> <span class="va">$BACKUP_DIR</span>/api_logs_<span class="va">$DATE</span>.tar.gz /opt/modernmath/api/logs/</span>
<span id="cb29-17"><a aria-hidden="true" href="#cb29-17" tabindex="-1"></a></span>
<span id="cb29-18"><a aria-hidden="true" href="#cb29-18" tabindex="-1"></a><span class="co"># Keep only last 7 days</span></span>
<span id="cb29-19"><a aria-hidden="true" href="#cb29-19" tabindex="-1"></a><span class="fu">find</span> <span class="va">$BACKUP_DIR</span> <span class="at">-mtime</span> +7 <span class="at">-delete</span></span>
<span id="cb29-20"><a aria-hidden="true" href="#cb29-20" tabindex="-1"></a></span>
<span id="cb29-21"><a aria-hidden="true" href="#cb29-21" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Backup completed: </span><span class="va">$DATE</span><span class="st">"</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="7.2.2" id="schedule-backup">
<h3 class="anchored" data-anchor-id="schedule-backup" data-number="7.2.2"><span class="header-section-number">7.2.2</span> Schedule Backup</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a aria-hidden="true" href="#cb30-1" tabindex="-1"></a><span class="co"># Add to crontab</span></span>
<span id="cb30-2"><a aria-hidden="true" href="#cb30-2" tabindex="-1"></a><span class="ex">0</span> 2 <span class="pp">*</span> <span class="pp">*</span> <span class="pp">*</span> /opt/modernmath/backup.sh</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level2" data-number="7.3" id="log-management">
<h2 class="anchored" data-anchor-id="log-management" data-number="7.3"><span class="header-section-number">7.3</span> Log Management</h2>
<section class="level3" data-number="7.3.1" id="configure-log-rotation">
<h3 class="anchored" data-anchor-id="configure-log-rotation" data-number="7.3.1"><span class="header-section-number">7.3.1</span> Configure Log Rotation</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/logrotate.d/modernmath</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
<pre><code>/opt/modernmath/api/logs/*.log {
    daily
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 www-data www-data
    sharedscripts
    postrotate
        systemctl reload mathwiki-api
    endscript
}

/opt/modernmath/fuseki/*.log {
    daily
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 fuseki fuseki
}</code></pre>
</section>
</section>
</section>
<section class="level1" data-number="8" id="rollback-procedures">
<h1 data-number="8"><span class="header-section-number">8</span> Rollback Procedures</h1>
<section class="level2" data-number="8.1" id="quick-rollback">
<h2 class="anchored" data-anchor-id="quick-rollback" data-number="8.1"><span class="header-section-number">8.1</span> Quick Rollback</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><a aria-hidden="true" href="#cb33-1" tabindex="-1"></a><span class="co"># Stop services</span></span>
<span id="cb33-2"><a aria-hidden="true" href="#cb33-2" tabindex="-1"></a><span class="fu">sudo</span> systemctl stop mathwiki-api fuseki</span>
<span id="cb33-3"><a aria-hidden="true" href="#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a aria-hidden="true" href="#cb33-4" tabindex="-1"></a><span class="co"># Restore from backup</span></span>
<span id="cb33-5"><a aria-hidden="true" href="#cb33-5" tabindex="-1"></a><span class="bu">cd</span> /opt/modernmath</span>
<span id="cb33-6"><a aria-hidden="true" href="#cb33-6" tabindex="-1"></a><span class="fu">git</span> checkout <span class="op">&lt;</span>previous-commit-hash<span class="op">&gt;</span></span>
<span id="cb33-7"><a aria-hidden="true" href="#cb33-7" tabindex="-1"></a></span>
<span id="cb33-8"><a aria-hidden="true" href="#cb33-8" tabindex="-1"></a><span class="co"># Rebuild</span></span>
<span id="cb33-9"><a aria-hidden="true" href="#cb33-9" tabindex="-1"></a><span class="ex">poetry</span> install <span class="at">--no-dev</span></span>
<span id="cb33-10"><a aria-hidden="true" href="#cb33-10" tabindex="-1"></a><span class="ex">poetry</span> run python scripts/build_graph.py</span>
<span id="cb33-11"><a aria-hidden="true" href="#cb33-11" tabindex="-1"></a><span class="ex">quarto</span> render</span>
<span id="cb33-12"><a aria-hidden="true" href="#cb33-12" tabindex="-1"></a></span>
<span id="cb33-13"><a aria-hidden="true" href="#cb33-13" tabindex="-1"></a><span class="co"># Restart services</span></span>
<span id="cb33-14"><a aria-hidden="true" href="#cb33-14" tabindex="-1"></a><span class="fu">sudo</span> systemctl start fuseki mathwiki-api</span>
<span id="cb33-15"><a aria-hidden="true" href="#cb33-15" tabindex="-1"></a></span>
<span id="cb33-16"><a aria-hidden="true" href="#cb33-16" tabindex="-1"></a><span class="co"># Reload data</span></span>
<span id="cb33-17"><a aria-hidden="true" href="#cb33-17" tabindex="-1"></a><span class="bu">cd</span> fuseki/scripts</span>
<span id="cb33-18"><a aria-hidden="true" href="#cb33-18" tabindex="-1"></a><span class="ex">./load_data.sh</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level2" data-number="8.2" id="database-rollback">
<h2 class="anchored" data-anchor-id="database-rollback" data-number="8.2"><span class="header-section-number">8.2</span> Database Rollback</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a><span class="co"># Stop Fuseki</span></span>
<span id="cb34-2"><a aria-hidden="true" href="#cb34-2" tabindex="-1"></a><span class="fu">sudo</span> systemctl stop fuseki</span>
<span id="cb34-3"><a aria-hidden="true" href="#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a aria-hidden="true" href="#cb34-4" tabindex="-1"></a><span class="co"># Restore data backup</span></span>
<span id="cb34-5"><a aria-hidden="true" href="#cb34-5" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> /opt/modernmath/fuseki/data/mathwiki</span>
<span id="cb34-6"><a aria-hidden="true" href="#cb34-6" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-xzf</span> /backup/modernmath/fuseki_data_<span class="op">&lt;</span>date<span class="op">&gt;</span>.tar.gz <span class="at">-C</span> /</span>
<span id="cb34-7"><a aria-hidden="true" href="#cb34-7" tabindex="-1"></a></span>
<span id="cb34-8"><a aria-hidden="true" href="#cb34-8" tabindex="-1"></a><span class="co"># Restart Fuseki</span></span>
<span id="cb34-9"><a aria-hidden="true" href="#cb34-9" tabindex="-1"></a><span class="fu">sudo</span> systemctl start fuseki</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
<section class="level1" data-number="9" id="performance-optimization">
<h1 data-number="9"><span class="header-section-number">9</span> Performance Optimization</h1>
<section class="level2" data-number="9.1" id="enable-caching">
<h2 class="anchored" data-anchor-id="enable-caching" data-number="9.1"><span class="header-section-number">9.1</span> Enable Caching</h2>
<section class="level3" data-number="9.1.1" id="nginx-caching">
<h3 class="anchored" data-anchor-id="nginx-caching" data-number="9.1.1"><span class="header-section-number">9.1.1</span> Nginx Caching</h3>
<p>Add to Nginx configuration:</p>
<pre class="nginx"><code>location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

location ~* \.(html)$ {
    expires 1h;
    add_header Cache-Control "public, must-revalidate";
}</code></pre>
</section>
<section class="level3" data-number="9.1.2" id="api-response-caching">
<h3 class="anchored" data-anchor-id="api-response-caching" data-number="9.1.2"><span class="header-section-number">9.1.2</span> API Response Caching</h3>
<p>Already implemented in the Flask API with in-memory caching.</p>
</section>
</section>
<section class="level2" data-number="9.2" id="cdn-setup-optional">
<h2 class="anchored" data-anchor-id="cdn-setup-optional" data-number="9.2"><span class="header-section-number">9.2</span> CDN Setup (Optional)</h2>
<p>For high-traffic deployments, consider using a CDN:</p>
<ol type="1">
<li>CloudFlare</li>
<li>AWS CloudFront</li>
<li>Fastly</li>
</ol>
</section>
</section>
<section class="level1" data-number="10" id="troubleshooting-deployment">
<h1 data-number="10"><span class="header-section-number">10</span> Troubleshooting Deployment</h1>
<section class="level2" data-number="10.1" id="common-issues">
<h2 class="anchored" data-anchor-id="common-issues" data-number="10.1"><span class="header-section-number">10.1</span> Common Issues</h2>
<section class="level3" data-number="10.1.1" id="port-already-in-use">
<h3 class="anchored" data-anchor-id="port-already-in-use" data-number="10.1.1"><span class="header-section-number">10.1.1</span> Port Already in Use</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a aria-hidden="true" href="#cb36-1" tabindex="-1"></a><span class="co"># Find process using port</span></span>
<span id="cb36-2"><a aria-hidden="true" href="#cb36-2" tabindex="-1"></a><span class="fu">sudo</span> lsof <span class="at">-i</span> :3030</span>
<span id="cb36-3"><a aria-hidden="true" href="#cb36-3" tabindex="-1"></a><span class="fu">sudo</span> lsof <span class="at">-i</span> :5001</span>
<span id="cb36-4"><a aria-hidden="true" href="#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a aria-hidden="true" href="#cb36-5" tabindex="-1"></a><span class="co"># Kill process if needed</span></span>
<span id="cb36-6"><a aria-hidden="true" href="#cb36-6" tabindex="-1"></a><span class="fu">sudo</span> kill <span class="at">-9</span> <span class="op">&lt;</span>PID<span class="op">&gt;</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="10.1.2" id="permission-errors">
<h3 class="anchored" data-anchor-id="permission-errors" data-number="10.1.2"><span class="header-section-number">10.1.2</span> Permission Errors</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a><span class="co"># Fix ownership</span></span>
<span id="cb37-2"><a aria-hidden="true" href="#cb37-2" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> www-data:www-data /opt/modernmath/api</span>
<span id="cb37-3"><a aria-hidden="true" href="#cb37-3" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> fuseki:fuseki /opt/modernmath/fuseki</span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
<section class="level3" data-number="10.1.3" id="service-wont-start">
<h3 class="anchored" data-anchor-id="service-wont-start" data-number="10.1.3"><span class="header-section-number">10.1.3</span> Service Won‚Äôt Start</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a><span class="co"># Check logs</span></span>
<span id="cb38-2"><a aria-hidden="true" href="#cb38-2" tabindex="-1"></a><span class="fu">sudo</span> journalctl <span class="at">-u</span> fuseki <span class="at">-f</span></span>
<span id="cb38-3"><a aria-hidden="true" href="#cb38-3" tabindex="-1"></a><span class="fu">sudo</span> journalctl <span class="at">-u</span> mathwiki-api <span class="at">-f</span></span>
<span id="cb38-4"><a aria-hidden="true" href="#cb38-4" tabindex="-1"></a></span>
<span id="cb38-5"><a aria-hidden="true" href="#cb38-5" tabindex="-1"></a><span class="co"># Check syntax</span></span>
<span id="cb38-6"><a aria-hidden="true" href="#cb38-6" tabindex="-1"></a><span class="fu">sudo</span> nginx <span class="at">-t</span></span></code><button class="code-copy-button" title="„Ç≥„Éî„Éº"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section class="level1" data-number="11" id="security-checklist">
<h1 data-number="11"><span class="header-section-number">11</span> Security Checklist</h1>
<ul class="task-list">
<li><label><input type="checkbox"/>SSL/TLS certificates installed and auto-renewing</label></li>
<li><label><input type="checkbox"/>Firewall configured (only required ports open)</label></li>
<li><label><input type="checkbox"/>Regular security updates scheduled</label></li>
<li><label><input type="checkbox"/>API rate limiting enabled</label></li>
<li><label><input type="checkbox"/>CORS properly configured</label></li>
<li><label><input type="checkbox"/>Input validation in place</label></li>
<li><label><input type="checkbox"/>Regular backups scheduled</label></li>
<li><label><input type="checkbox"/>Monitoring and alerting configured</label></li>
<li><label><input type="checkbox"/>Access logs reviewed regularly</label></li>
<li><label><input type="checkbox"/>Fail2ban or similar intrusion prevention</label></li>
</ul>
</section>
<section class="level1" data-number="12" id="post-deployment-verification">
<h1 data-number="12"><span class="header-section-number">12</span> Post-Deployment Verification</h1>
<ol type="1">
<li><strong>Website Access</strong>: Visit all major pages</li>
<li><strong>Search Functionality</strong>: Test search feature</li>
<li><strong>Visualizations</strong>: Verify interactive graphs load</li>
<li><strong>API Endpoints</strong>: Test all API endpoints</li>
<li><strong>SPARQL Queries</strong>: Run test queries</li>
<li><strong>Cross-References</strong>: Click through several links</li>
<li><strong>Performance</strong>: Check page load times</li>
<li><strong>Mobile View</strong>: Test responsive design</li>
<li><strong>SSL Certificate</strong>: Verify HTTPS works</li>
<li><strong>Monitoring</strong>: Confirm health checks pass</li>
</ol>
<p>Congratulations! Your ModernMath Knowledge Graph is now deployed and operational.</p>
</section>
</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
<div class="nav-footer">
<div class="nav-footer-left">
      ¬†
    </div>
<div class="nav-footer-center">
<p>Êï∞Â≠¶„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„ÉïWiki - Quarto „Å® RDF „ÅßÊßãÁØâ</p>
</div>
<div class="nav-footer-right">
      ¬†
    </div>
</div>
</footer>
<a class="bmc-custom-button" href="https://www.buymeacoffee.com/RK0429" rel="noopener noreferrer" target="_blank"><img alt="Buy Me a Coffee" src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" style="height: 36px !important;width: auto !important;"/></a></body></html>